openapi: 3.0.0
info:
  description: The ETSI MEC ISG MEC015 Bandwidth Management API described using OpenAPI
  version: 1.1.1
  title: BWM API
  license:
    name: ETSI Forge copyright notice
    url: https://forge.etsi.org/etsi-forge-copyright-notice.txt
externalDocs:
  description: ETSI MEC015 V1.1.1 Bandwidth Management API
  url: http://www.etsi.org/deliver/etsi_gs/MEC/001_099/015/01.01.01_60/gs_MEC015v010101p.pdf
security:
  - OauthSecurity:
      - all
paths:
  /bw_allocations:
    get:
      description: This method retrieves information about a list of bandwidthAllocation
        resources
      parameters:
       # - $ref: "#/components/parameters/Query.AppInstanceId"
        - name: app_ins_id #Query.AppInstanceId
          in: query
          description: Application Instance ID
          required: false
          schema:
            type: string       
       # - $ref: "#/components/parameters/Query.AppName"
        - name: application_name #Query.AppName
          in: query
          description: Application Name
          required: false
          schema:
            type: array
            items:
              type: string
       # - $ref: "#/components/parameters/Query.SessionId"
        - name: session_id #Query.SessionId
          in: query
          required: false
          description: Session Identifier for use in IP-based multimedia communication systems that enables endpoints as a bit string (size (28)), as defined in RFC 7329
          schema:
            type: array
            items:
              type: string
      responses:
        "200":
          description: Upon success, a response body containing an array of the
            bandwidthAllocations is returned.
          content:
            application/json:
              schema:
              #  required:
              #    - bwInfo
              #  properties:
              #    bwInfo:
                $ref: "#/components/schemas/BwInfo"
        "400":
          description: It is used to indicate that incorrect parameters were passed to the
            request. In the returned ProblemDetails structure, the "detail"
            attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "403":
          description: The operation is not allowed given the current status of the
            resource. More information should be provided in the "detail"
            attribute of the "ProblemDetails" structure.
          content:
            application/json:
              schema:
                required:
                  - ProblemDetails
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "404":
          description: It is used when a client provided a URI that cannot be mapped to a
            valid resource URI. In the returned ProblemDetails structure, the
            "detail" attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
    post:
      description: This method is used to create a bandwidthAllocation resource.
      requestBody:
        $ref: "#/components/requestBodies/BwInfo"
      responses:
        "201":
          description: Upon success, the HTTP response shall include a "Location" HTTP
            header that contains the resource URI of the created resource.
          content:
            application/json:
              schema:
              #  required:
              #    - bwInfo
              #  properties:
              #    bwInfo:
                $ref: "#/components/schemas/BwInfo"
        "400":
          description: It is used to indicate that incorrect parameters were passed to the
            request. In the returned ProblemDetails structure, the "detail"
            attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "403":
          description: The operation is not allowed given the current status of the
            resource. More information should be provided in the "detail"
            attribute of the "ProblemDetails" structure.
          content:
            application/json:
              schema:
                required:
                  - ProblemDetails
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "404":
          description: It is used when a client provided a URI that cannot be mapped to a
            valid resource URI. In the returned ProblemDetails structure, the
            "detail" attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
  "/bw_allocations/{allocationId}":
    get:
      description: "This method retrieves information about a specific bandwidthAllocation
        resource. "
      parameters:
        - $ref: "#/components/parameters/Path.AllocationId"
      #  - name: allocationId #Path.AllocationId
      #    in: query
      #    required: false
      #    description: TBD
      #    schema:
      #      type: array
      #      items:
      #        type: string
      responses:
        "200":
          description: It is used to indicate nonspecific success. The response body
            contains a representation of the resource.
          content:
            application/json:
              schema:
              #  required:
              #    - bwInfo
              #  properties:
              #    bwInfo:
                $ref: "#/components/schemas/BwInfo"
        "400":
          description: It is used to indicate that incorrect parameters were passed to the
            request. In the returned ProblemDetails structure, the "detail"
            attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "403":
          description: >-
            The operation is not allowed given the current status of the
            resource. More information shall be provided in the "detail"
            attribute of the "ProblemDetails" structure. required:
              - ProblemDetails
            properties:
              ProblemDetails:
                $ref: '#/definitions/ProblemDetails'
        "404":
          description: It is used when a client provided a URI that cannot be mapped to a
            valid resource URI. In the returned ProblemDetails structure, the
            "detail" attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
    put:
      description: "This method updates the information about a specific
        bandwidthAllocation resource. "
      parameters:
        - $ref: "#/components/parameters/Path.AllocationId"
      requestBody:
        $ref: "#/components/requestBodies/BwInfo"
      responses:
        "200":
          description: Upon success, a response body containing data type describing the
            updated BwInfo is returned.
          content:
            application/json:
              schema:
              #  required:
              #    - bwInfo
              #  properties:
              #    bwInfo:
                $ref: "#/components/schemas/BwInfo"
        "400":
          description: It is used to indicate that incorrect parameters were passed to the
            request. In the returned ProblemDetails structure, the "detail"
            attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "403":
          description: The operation is not allowed given the current status of the
            resource. More information shall be provided in the "detail"
            attribute of the "ProblemDetails" structure.
          content:
            application/json:
              schema:
                required:
                  - ProblemDetails
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "404":
          description: It is used when a client provided a URI that cannot be mapped to a
            valid resource URI. In the returned ProblemDetails structure, the
            "detail" attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "412":
          description: It is used when a condition has failed during conditional requests,
            e.g. when using ETags to avoid write conflicts. In the returned
            ProblemDetails structure, the "detail" attribute should convey more
            information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
    patch:
      description: "This method updates the information about a specific
        bandwidthAllocation resource. "
      parameters:
        - $ref: "#/components/parameters/Path.AllocationId"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BwInfoDeltas"
        description: "Description of the changes to instruct the server how to modify the
          resource representation. "
        required: true
      responses:
        "200":
          description: Upon success, a response body containing data type describing the
            updated BwInfo is returned.
          content:
            application/json:
              schema:
              #  required:
              #    - bwInfo
              #  properties:
              #    bwInfo:
                $ref: "#/components/schemas/BwInfo"
        "400":
          description: It is used to indicate that incorrect parameters were passed to the
            request. In the returned ProblemDetails structure, the "detail"
            attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "403":
          description: The operation is not allowed given the current status of the
            resource. More information shall be provided in the "detail"
            attribute of the "ProblemDetails" structure.
          content:
            application/json:
              schema:
                required:
                  - ProblemDetails
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "404":
          description: It is used when a client provided a URI that cannot be mapped to a
            valid resource URI. In the returned ProblemDetails structure, the
            "detail" attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "412":
          description: It is used when a condition has failed during conditional requests,
            e.g. when using ETags to avoid write conflicts. In the returned
            ProblemDetails structure, the "detail" attribute should convey more
            information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
    delete:
      description: Remove a specific bandwidthAllocation resource. DELETE method is
        typically used in "Unregister from Bandwidth Management Service"
        procedure
      parameters:
        - $ref: "#/components/parameters/Path.AllocationId"
      responses:
        "204":
          description: No Content
        "403":
          description: The operation is not allowed given the current status of the
            resource. More information shall be provided in the "detail"
            attribute of the "ProblemDetails" structure.
          content:
            application/json:
              schema:
                required:
                  - ProblemDetails
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
        "404":
          description: It is used when a client provided a URI that cannot be mapped to a
            valid resource URI. In the returned ProblemDetails structure, the
            "detail" attribute should convey more information about the error.
          content:
            application/json:
              schema:
                properties:
                  ProblemDetails:
                    $ref: "#/components/schemas/ProblemDetails"
servers:
  - url: http://127.0.0.1:8081/bwm/v1
  - url: https://127.0.0.1:8081/bwm/v1
components:
  parameters:
    Path.AllocationId:
      name: allocationId
      in: path
      description: Represents a bandwidth allocation instance
      required: true
      schema:
        type: string
    Query.AppInstanceId:
      name: app_instance_id
      in: query
      description: "A mobile edge application instance may use multiple app_instance_ids as
        an input parameter to query the bandwidth allocation of a list of mobile
        edge application instances. "
      required: false
      schema:
        type: array
        items:
          type: string
    Query.AppName:
      name: app_name
      in: query
      description: "A mobile edge application instance may use multiple ser_names as an
        input parameter to query the bandwidth allocation of a list of mobile
        edge application instances. "
      required: false
      schema:
        type: array
        items:
          type: string
    Query.SessionId:
      name: session_id
      in: query
      description: "A mobile edge application instance may use session_id as an input
        parameter to query the bandwidth allocation of a list of sessions. "
      required: false
      schema:
        type: array
        items:
          type: string
  requestBodies:
    BwInfo:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/BwInfo"
      description: BwInfo with updated information is included as entity body of the request
      required: true
  securitySchemes:
    OauthSecurity:
      type: oauth2
      flows:
        clientCredentials:
          tokenUrl: https://oauth.exampleAPI/token
          scopes:
            all: Single oauth2 scope for API
  schemas:
    ProblemDetails:
      type: object
      properties:
        type:
          $ref: "#/components/schemas/Problem.type"
        title:
          $ref: "#/components/schemas/Problem.title"
        status:
          $ref: "#/components/schemas/Problem.status"
        detail:
          $ref: "#/components/schemas/Problem.detail"
        instance:
          $ref: "#/components/schemas/Problem.instance"
    Problem.type:
      type: string
      format: uri
      description: A URI reference according to IETF RFC 3986 that identifies the problem
        type
    Problem.title:
      type: string
      description: A short, human-readable summary of the problem type
    Problem.status:
      type: integer
      format: uint32
      description: The HTTP status code for this occurrence of the problem
    Problem.detail:
      type: string
      description: A human-readable explanation specific to this occurrence of the problem
    Problem.instance:
      type: string
      format: uri
      description: A URI reference that identifies the specific occurrence of the problem
    BwInfo:
      description: information of bandwidth resource
      type: object
      required:
        - appInsId
        - requestType
        - fixedAllocation
        - allocationDirection
      properties:
        timeStamp:
          $ref: "#/components/schemas/TimeStamp"
        appInsId:
          $ref: "#/components/schemas/AppInsId"
        requestType:
          $ref: "#/components/schemas/RequestType"
        sessionFilter:
          $ref: "#/components/schemas/SessionFilter"
        fixedBWPriority:
          $ref: "#/components/schemas/FixedBWPriority"
        fixedAllocation:
          $ref: "#/components/schemas/FixedAllocation"
        allocationDirection:
          $ref: "#/components/schemas/AllocationDirection"
    BwInfoDeltas:
      description: Conform to JSON merge patch format and processing rules specified IETF
        RFC 7396 [8], this type represents the attributes whose value are
        allowed to be updated with HTTP PATCH method in content format JSON
      type: object
      properties:
        appInsId:
          $ref: "#/components/schemas/AppInsId"
        requestType:
          $ref: "#/components/schemas/RequestType"
        sessionFilter:
          $ref: "#/components/schemas/SessionFilter"
        fixedBWPriority:
          $ref: "#/components/schemas/FixedBWPriority"
        fixedAllocation:
          $ref: "#/components/schemas/FixedAllocation"
        allocationDirection:
          $ref: "#/components/schemas/AllocationDirection"
    TimeStamp:
      type: object
      required:
        - seconds
        - nanoSeconds
      properties:
        seconds:
          $ref: "#/components/schemas/Seconds"
        nanoSeconds:
          $ref: "#/components/schemas/NanoSeconds"
    AppInsId:
      description: Application instance identifier
      type: string
    RequestType:
      description: Numeric value (0 - 255) corresponding to specific type of consumer
      type: string
      enum:
        - APPLICATION_SPECIFIC_BW_ALLOCATION
        - SESSION_SPECIFIC_BW_ALLOCATION
    SessionFilter:
      description: Session filtering criteria, applicable when requestType is set as
        SESSION_SPECIFIC_BW_ALLOCATION. Any filtering criteria shall define a
        single session only. In case multiple sessions match sessionFilter the
        request shall be rejected
      type: array
      items:
        $ref: "#/components/schemas/sessionFilterElement"
          
    sessionFilterElement:
        type: object
        properties:
          sourceIp:
            $ref: "#/components/schemas/SourceIp"
          sourcePort:
            $ref: "#/components/schemas/SourcePort"
          dstAddress:
            $ref: "#/components/schemas/DstAddress"
          dstPort:
            $ref: "#/components/schemas/DstPort"
          protocol:
            $ref: "#/components/schemas/Protocol"
                    
    FixedBWPriority:
      description: Indicates the allocation priority when dealing with several applications
        or sessions in parallel. Values are not defined in the present document
      type: string
      enum:
        - not defined in the present document
    FixedAllocation:
      description: Size of requested fixed BW allocation in [bps]
      type: string
    AllocationDirection:
      description: The direction of the requested BW allocation
      type: string
      enum:
        - 00 = Downlink (towards the UE)
        - 01 = Uplink (towards the application/session)
        - 10 = Symmetrical
    Seconds:
      description: The seconds part of the Time. Time is defined as Unix-time since January
        1, 1970, 00:00:00 UTC
      type: integer
      format: uint32
    NanoSeconds:
      description: The nanoseconds part of the Time. Time is defined as Unix-time since
        January 1, 1970, 00:00:00 UTC
      type: integer
      format: uint32
    SourceIp:
      description: Source address identity of session (including range)
      type: string
    SourcePort:
      description: "Source port identity of session "
      type: array
      items:
        type: string
    DstAddress:
      description: Destination address identity of session (including range)
      type: string
    DstPort:
      description: "Destination port identity of session "
      type: array
      items:
        type: string
    Protocol:
      description: Protocol number
      type: string
